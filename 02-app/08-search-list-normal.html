<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>用户列表</title>
    <script src="../lib/vue.global.js"></script>
    <style>
        .container {
            margin: 50px;
        }

        .content {
            margin: 20px;
        }
    </style>
</head>
<body>
<div id="Application">
    <div class="container">
        <div class="content">
            <input type="radio" :value="-1" v-model="sexFilter"/>全部
            <input type="radio" :value="0" v-model="sexFilter"/>男
            <input type="radio" :value="1" v-model="sexFilter"/>女
        </div>
        <div class="content">搜索：<input type="text" v-model="searchKey"/></div>
        <div class="content">
            <table border="1" width="300px">
                <tr>
                    <th>姓名</th>
                    <th>性别</th>
                </tr>
                <tr v-for="(data, index) in showData">
                    <td>{{data.name}}</td>
                    <td>{{data.sex === 0 ? '男' : '女'}}</td>
                </tr>
            </table>
        </div>
    </div>
</div>
<script>
    let mock = [
        {
            name: "小王",
            sex: 0
        }, {
            name: "小红",
            sex: 1
        }, {
            name: "小李",
            sex: 1
        }, {
            name: "小张",
            sex: 0
        }
    ]

    const {createApp, ref} = Vue;
    const config = {
        //data选项中默认返回的数据都是响应式的
        data() {
            return {
                sexFilter: -1,
                searchKey: '',
                showData: []
            }
        },
        mounted() {
            setTimeout(this.loadData, 1000);
        },
        methods: {
            loadData() {
                this.showData = mock;
            },
            filterData() {
                this.searchKey = "";
                if (this.sexFilter === -1) {
                    this.loadData();
                } else {
                    this.showData = mock.filter((e) => {
                        return e.sex === this.sexFilter;
                    })
                }
            },
            searchData() {
                this.sexFilter = -1;
                if (this.searchKey === "") {
                    this.loadData();
                } else {
                    this.showData = mock.filter((e) => {
                        return e.name.search(this.searchKey) !== -1;
                    })
                }
            }
        },
        watch: {
            sexFilter(oldValue, newValue) {
                console.log("sex Filter:Old" + oldValue + ",new:" + newValue);
                console.log(this.sexFilter === 0);
                this.filterData();
            },
            searchKey(oldValue, newValue) {
                this.searchData();
            }
        }
    }
    const App = createApp(config);
    App.mount("#Application")
</script>
</body>
</html>